package com.xzkj.smsService.controller;


import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.xzkj.smsService.entity.TUser;
import com.xzkj.smsService.entity.User;
import com.xzkj.smsService.service.TUserService;
import com.xzkj.utils.MD5Utils;
import com.xzkj.utils.R;
import lombok.extern.slf4j.Slf4j;
import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.cloud.context.config.annotation.RefreshScope;
import org.springframework.http.MediaType;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;

import org.springframework.web.bind.annotation.RestController;

import javax.annotation.PostConstruct;
import java.io.UnsupportedEncodingException;
import java.net.URLDecoder;
import java.util.*;

/**
 * <p>
 *  前端控制器
 * </p>
 *
 * @author LinMengHao
 * @since 2022-10-13
 */

@Slf4j
@RefreshScope
@RestController
@RequestMapping("/baseservice/t-user")
public class TUserController {
    @Autowired
    TUserService service;
    @Value("${lmh.name}")
    private String name;
    @Value("${lmh.age}")
    private Integer age;

    @Value("${lmh.phone}")
    private List<Integer> phone=new ArrayList<>();


    @PostMapping(value = "findAll",consumes = {MediaType.APPLICATION_JSON_VALUE},
    produces = {MediaType.APPLICATION_JSON_VALUE})
    public R test(){
        List<TUser> list= service.findAll();
        log.info(list.toString());
        log.info("name: "+name);
        log.info("age: "+age);
        log.info("phone"+phone.toString());
        return R.ok();
    }
    @Test
    public void test1(){
        long time = new Date().getTime();
        System.out.println("ts:"+time);
        String s = MD5Utils.MD5Encode("acc=xiuzhi&ts="+time+"&sign=1"+"|||pwd=xiuzhi66");
        System.out.println("token:"+s);
    }
    @Test
    public void tes(){
        long time = new Date().getTime();
        System.out.println("ts:"+time);
        String s = MD5Utils.MD5Encode("acc=xiuzhi&ts="+time+"|||pwd=xiuzhi66");
        System.out.println("token:"+s);
    }


    @Test
    public void test2(){
        JSONObject jsonObject=new JSONObject();
        JSONObject params=new JSONObject();
        String[] split = "hhh,lll,xxx".split(",");
        for (int i = 1; i <= split.length; i++) {
            String key="v"+i;
            params.put(key,split[i-1]);
        }
        jsonObject.put("vars",params.toString());
        System.out.println(params.toJSONString());
        System.out.println(jsonObject.toJSONString());
    }
    @Test
    public void test3(){
        String spid="1195";
        String login="admin";
        String pwd= MD5Utils.MD5Encode(login+"!yJIE7TU6").toUpperCase();
        JSONObject submitJson = new JSONObject();
        submitJson.put("phones","18756232770");
        submitJson.put("sn","20221116111300001");
        submitJson.put("spid",spid);
        submitJson.put("login",login);
        submitJson.put("pwd",pwd);
        submitJson.put("tid","221116102159200002");
        System.out.println(submitJson.toJSONString());
    }
    @Test
    public void test4() throws UnsupportedEncodingException {
        String decode = URLDecoder.decode("");
        System.out.println(decode);
    }
    @Test
    public void test_4() throws UnsupportedEncodingException {
        String decode = URLDecoder.decode("body=reports=221126151240129669%2C17398515826%2C0%2CDELIVRD%2C20221126_1500033734337%2C20221126151313%3B221126151246129875%2C18056415197%2C0%2CDELIVRD%2C20221126_1500054904543%2C20221126151313%3B221126151240129667%2C17398339618%2C0%2CDELIVRD%2C20221126_1500033564335%2C20221126151313%3B221126151243129786%2C17777630539%2C0%2CDELIVRD%2C20221126_1500042484454%2C20221126151313%3B221126151242129755%2C17774890794%2C0%2CDELIVRD%2C20221126_1500040974422%2C20221126151313%3B221126151245129847%2C18032271273%2C0%2CDELIVRD%2C20221126_1500051134515%2C20221126151313%3B221126151242129734%2C17758616859%2C0%2CDELIVRD%2C20221126_1500039294402%2C20221126151313%3B221126151245129849%2C18039076700%2C0%2CDELIVRD%2C20221126_1500051324517%2C20221126151313%3B221126151242129763%2C17776460829%2C0%2CDELIVRD%2C20221126_1500041364431%2C20221126151313%3B221126151239129648%2C17377562275%2C0%2CDELIVRD%2C20221126_1500031034315%2C20221126151313%3B221126151242129757%2C17775290716%2C0%2CDELIVRD%2C20221126_1500041174426%2C20221126151313%3B221126151245129840%2C18030023050%2C0%2CDELIVRD%2C20221126_1500050454508%2C20221126151313%3B221126151239129638%2C17376225119%2C0%2CDELIVRD%2C20221126_1500030184306%2C20221126151313%3B221126151241129715%2C17738009361%2C0%2CDELIVRD%2C20221126_1500037774383%2C20221126151313%3B221126151242129768%2C17776570322%2C0%2CDELIVRD%2C20221126_1500041634436%2C20221126151313%3B221126151244129813%2C18004872670%2C0%2CDELIVRD%2C20221126_1500043844481%2C20221126151313%3B221126151241129726%2C17755894181%2C0%2CDELIVRD%2C20221126_1500038804394%2C20221126151313%3B221126151244129809%2C17799269515%2C0%2CDELIVRD%2C20221126_1500043474476%2C20221126151313%3B221126151243129796%2C17785195832%2C0%2CDELIVRD%2C20221126_1500042944465%2C20221126151313%3B221126151243129783%2C17777555797%2C0%2CDELIVRD%2C20221126_1500042314451%2C20221126151313%3B221126151243129777%2C17777334210%2C0%2CDELIVRD%2C20221126_1500042024445%2C20221126151313%3B221126151243129775%2C17776578868%2C0%2CDELIVRD%2C20221126_1500041934443%2C20221126151313%3B221126151242129751%2C17772033086%2C0%2CDELIVRD%2C20221126_1500040784419%2C20221126151313%3B221126151243129788%2C17777995869%2C0%2CDELIVRD%2C20221126_1500042574456%2C20221126151313%3B221126151243129769%2C17776447565%2C0%2CDELIVRD%2C20221126_1500041644437%2C20221126151313%3B221126151243129771%2C17776667350%2C0%2CDELIVRD%2C20221126_1500041744439%2C20221126151313%3B221126151245129843%2C18032725309%2C0%2CDELIVRD%2C20221126_1500050744511%2C20221126151313%3B221126151245129869%2C18052843602%2C0%2CDELIVRD%2C20221126_1500054344537%2C20221126151313%3B221126151242129758%2C17774851306%2C0%2CDELIVRD%2C20221126_1500041084425%2C20221126151313%3B221126151241129731%2C17758596083%2C0%2CDELIVRD%2C20221126_1500039114399%2C20221126151313%3B221126151245129863%2C18046741896%2C0%2CDELIVRD%2C20221126_1500052594531%2C20221126151313%3B221126151243129773%2C17776714883%2C0%2CDELIVRD%2C20221126_1500041834441%2C20221126151313%3B221126151243129770%2C17776575332%2C0%2CDELIVRD%2C20221126_1500041734438%2C20221126151313%3B221126151247129930%2C18078511157%2C0%2CDELIVRD%2C20221126_1500060444598%2C20221126151313%3B221126151248129955%2C18093811052%2C0%2CDELIVRD%2C20221126_1500063504623%2C20221126151313%3B221126151248129965%2C18105632093%2C0%2CDELIVRD%2C20221126_1500064444633%2C20221126151313%3B221126151243129792%2C17777683833%2C0%2CDELIVRD%2C20221126_1500042744460%2C20221126151313%3B221126151246129908%2C18077048921%2C0%2CDELIVRD%2C20221126_1500057914576%2C20221126151313%3B221126151239129646%2C17377288615%2C0%2CDELIVRD%2C20221126_1500030934314%2C20221126151313%3B221126151246129887%2C18068373641%2C0%2CDELIVRD%2C20221126_1500056024555%2C20221126151313%3B221126151246129878%2C18056966030%2C0%2CDELIVRD%2C20221126_1500055174546%2C20221126151313%3B221126151245129868%2C18054052871%2C0%2CDELIVRD%2C20221126_1500054244536%2C20221126151313%3B221126151243129785%2C17777440140%2C0%2CDELIVRD%2C20221126_1500042404453%2C20221126151313%3B221126151248129959%2C18097517150%2C0%2CDELIVRD%2C20221126_1500063854627%2C20221126151313%3B221126151246129900%2C18076424604%2C0%2CDELIVRD%2C20221126_1500057184568%2C20221126151313%3B221126151248129945%2C18090218313%2C0%2CDELIVRD%2C20221126_1500061814613%2C20221126151313%3B221126151246129877%2C18056966982%2C0%2CDELIVRD%2C20221126_1500055084545%2C20221126151313%3B221126151248129960%2C18095874802%2C0%2CDELIVRD%2C20221126_1500063944628%2C20221126151313%3B221126151246129906%2C18075208279%2C0%2CDELIVRD%2C20221126_1500057724574%2C20221126151313%3B221126151248129974%2C18110542667%2C0%2CDELIVRD%2C20221126_1500065234642%2C20221126151313%3B221126151246129893%2C18070870513%2C0%2CDELIVRD%2C20221126_1500056584561%2C20221126151313%3B221126151246129901%2C18074927028%2C0%2CDELIVRD%2C20221126_1500057274569%2C20221126151313%3B221126151248129967%2C18105526675%2C0%2CDELIVRD%2C20221126_1500064624635%2C20221126151313%3B221126151246129902%2C18075388785%2C0%2CDELIVRD%2C20221126_1500057364570%2C20221126151313%3B221126151246129907%2C18076707942%2C0%2CDELIVRD%2C20221126_1500057824575%2C20221126151314%3B221126151245129873%2C18055555795%2C0%2CDELIVRD%2C20221126_1500054714541%2C20221126151313%3B221126151247129927%2C18078312516%2C0%2CDELIVRD%2C20221126_1500060164595%2C20221126151313%3B221126151247129922%2C18077874791%2C0%2CDELIVRD%2C20221126_1500059674590%2C20221126151313%3B221126151246129890%2C18070838856%2C0%2CDELIVRD%2C20221126_1500056304558%2C20221126151313%3B221126151246129885%2C18070699753%2C0%2CDELIVRD%2C20221126_1500055834553%2C20221126151314%3B221126151248129976%2C18113188569%2C0%2CDELIVRD%2C20221126_1500065404644%2C20221126151314%3B221126151247129932%2C18078733554%2C0%2CDELIVRD%2C20221126_1500060624600%2C20221126151314%3B221126151247129928%2C18078279322%2C0%2CDELIVRD%2C20221126_1500060264596%2C20221126151314%3B221126151247129912%2C18077306782%2C0%2CDELIVRD%2C20221126_1500058294580%2C20221126151314%3B221126151247129919%2C18078033424%2C0%2CDELIVRD%2C20221126_1500059374587%2C20221126151314%3B221126151248129977%2C18110864194%2C0%2CDELIVRD%2C20221126_1500065484645%2C20221126151314%3B221126151248129952%2C18096900049%2C0%2CDELIVRD%2C20221126_1500063224620%2C20221126151314%3B221126151243129787%2C17777575228%2C0%2CDELIVRD%2C20221126_1500042494455%2C20221126151314%3B221126151245129870%2C18055528097%2C0%2CDELIVRD%2C20221126_1500054434538%2C20221126151314%3B221126151245129862%2C18051771261%2C0%2CDELIVRD%2C20221126_1500052514530%2C20221126151314%3B221126151247129923%2C18078225806%2C0%2CDELIVRD%2C20221126_1500059774591%2C20221126151314%3B221126151246129882%2C18056175665%2C0%2CDELIVRD%2C20221126_1500055554550%2C20221126151314%3B221126151248129968%2C18107365626%2C0%2CDELIVRD%2C20221126_1500064714636%2C20221126151314%3B221126151248129971%2C18108905791%2C0%2CDELIVRD%2C20221126_1500064974639%2C20221126151314%3B221126151247129913%2C18077338363%2C0%2CDELIVRD%2C20221126_1500058384581%2C20221126151314%3B221126151246129888%2C18070906059%2C0%2CDELIVRD%2C20221126_1500056114556%2C20221126151314%3B221126151247129918%2C18077929273%2C0%2CDELIVRD%2C20221126_1500059274586%2C20221126151314%3B221126151247129911%2C18077191543%2C0%2CDELIVRD%2C20221126_1500058194579%2C20221126151314%3B221126151247129917%2C18077462474%2C0%2CDELIVRD%2C20221126_1500059174585%2C20221126151314%3B221126151248129956%2C18098527629%2C0%2CDELIVRD%2C20221126_1500063584624%2C20221126151314%3B221126151247129925%2C18078176719%2C0%2CDELIVRD%2C20221126_1500059964593%2C20221126151314%3B221126151248129980%2C18116886768%2C0%2CDELIVRD%2C20221126_1500065764648%2C20221126151314%3B221126151246129880%2C18056995068%2C0%2CDELIVRD%2C20221126_1500055364548%2C20221126151314%3B221126151248129979%2C18113689594%2C0%2CDELIVRD%2C20221126_1500065674647%2C20221126151314%3B221126151248129961%2C18098757828%2C0%2CDELIVRD%2C20221126_1500064084629%2C20221126151314%3B221126151246129903%2C18076318582%2C0%2CDELIVRD%2C20221126_1500057454571%2C20221126151314%3B221126151246129909%2C18076798712%2C0%2CDELIVRD%2C20221126_1500058004577%2C20221126151314%3B221126151247129935%2C18078567843%2C0%2CDELIVRD%2C20221126_1500060944603%2C20221126151314%3B221126151247129914%2C18076711925%2C0%2CDELIVRD%2C20221126_1500058484582%2C20221126151314%3B221126151247129926%2C18077551728%2C0%2CDELIVRD%2C20221126_1500060064594%2C20221126151314%3B221126151241129714%2C17745637277%2C0%2CDELIVRD%2C20221126_1500037694382%2C20221126151314%3B221126151242129739%2C17761131691%2C0%2CDELIVRD%2C20221126_1500039584409%2C20221126151314%3B221126151241129722%2C17755161955%2C0%2CDELIVRD%2C20221126_1500038314389%2C20221126151314%3B");

        System.out.println(decode);
    }
    @Test
    public void test5(){
        Map<String,String> map=new HashMap<>();
        map.put("phone","18756232770");
        map.put("param","99999");
        List<Map<String,String>> list=new ArrayList<>();
        list.add(map);
        JSONObject submitJson = new JSONObject();
        submitJson.put("phones",list);
        System.out.println("map: "+map.toString());
        System.out.println("list: "+list.toString());
        System.out.println("json: "+submitJson.toJSONString());
    }
    @Test
    public void test6(){
        JSONObject submitJson = new JSONObject();
        submitJson.put("Phones","mobile");
        submitJson.put("SiID","siId");
        submitJson.put("Authenticator","authenticator");
        submitJson.put("Date","date");
        submitJson.put("Method","send");
        submitJson.put("MsgID","channelMmsId");
        List<JSONObject> content=new ArrayList<>();
        submitJson.put("Method","option");
        String channelParam="v1=djskdj,v2=dshdksj,v3=shdsj,v4=oqieo3h4";
        String[] split = channelParam.split(",");
        for (int i = 1; i <= split.length; i++) {
            JSONObject jsonObject=new JSONObject();
            jsonObject.put("Frame","001-"+i);
            JSONObject jsonObject1=new JSONObject();
            String[] value=split[i-1].split("=");
            jsonObject1.put(value[0],value[1]);
            jsonObject.put("Param",jsonObject1);
            content.add(jsonObject);
        }
        submitJson.put("content",content);
        System.out.println(submitJson.toJSONString());

        List<String> reportList = submitJson.containsKey("content")?submitJson.getObject("content",List.class):new ArrayList<>();
        System.out.println(reportList.toString());
    }

    @Test
    public void test7(){
        JSONObject submitJson = new JSONObject();
        submitJson.put("content","[{\"type\":1,\"ext\":\"txt\",\"body\":\"…\"},{\"type\":2,\"ext\":\"jpg\",\"body\":\"…\"}]");

        JSONArray content = submitJson.getJSONArray("content");
        JSONObject jsonObject=new JSONObject();
        jsonObject.put("name","lmh");
        content.add(jsonObject);
        System.out.println(JSONObject.parseObject(content.getString(2)).get("name"));
    }
    @Test
    public void test8(){
        String channelParam="date1=11月28日";
        StringBuilder stringBuilder=new StringBuilder();
        String[] split = channelParam.split(",");
        for (int i = 0; i < split.length; i++) {
            String[] split1 = split[i].split("=");
            stringBuilder.append(split1[1]);
            if(i!=split.length-1){
                stringBuilder.append(",");
            }
        }
        System.out.println(stringBuilder.toString());
    }
}

